# GAME DESIGN

moodtown의 게임화 요소에 대한 상세 설명입니다.

## 마을 분위기 시스템

### ❤︎ 컨셉 및 목적
- 사용자의 감정 상태가 마을의 하늘 색에 반영되어,
감정 변화가 시각적으로 느껴지도록 하는 연출 시스템.
- 감정 분석 결과를 직관적으로 시각화
- 사용자에게 감정의 흐름을 자연스럽게 전달
- 마을의 감정적 분위기를 형성하는 핵심 연출 요소

### ❤︎ 작동 메커니즘
- 하루 일기에서 **가장 비중이 높은 감정**을 확인
- 해당 감정의 고유 색상으로 하늘 색이 부드럽게 변화
- 감정별 색상 예:
  - 기쁨(노랑): 따뜻한 노란 하늘
  - 슬픔(파랑): 푸른빛 하늘
  - 분노(빨강): 붉은 빛 하늘
  - 사랑(초록): 부드러운 연두색 톤
- 프론트엔드에서는 `EmotionSky` 컴포넌트가 이 색상 변화를 구현

<br>

## 행복 나무
### 컨셉 및 목적
- 긍정적인 감정이 쌓일 수록 자라는 나무
- 긍정적인 감정 표현을 장려하기 위한 보상 시스템  
- 감정의 변화를 시각적 성취로 연결

### 작동 메커니즘

#### ❥ 감정 기여도
다음 감정들이 행복 나무의 성장에 기여합니다:
- **기쁨**: 즐거움, 행복, 신남
- **사랑**: 애정, 우정, 따뜻함
- **놀람** (긍정적): 기쁜 소식, 반가운 소식 등
- **부끄러움** (긍정적): 설레는 감정, 좋아하는 사람에 대한 부끄러움 등
- 하루에 긍정 감정만 있으면 보너스 성장도 25점이 추가됩니다.

**주의**: 놀람과 부끄러움은 문맥에 따라 긍정/부정으로 구분됩니다. 자세한 내용은 [프로젝트 소개](INTRO.md#문맥-기반-감정-분류)를 참고하세요.

#### ❥ 성장 단계
나무는 여러 단계로 성장합니다:

| 단계       | 필요 점수 |
| -------- | ----- |
| 씨앗       | 0 이상 |
| 새싹       | 40 이상 |
| 묘목       | 100 이상   |
| 중간 나무    | 220 이상  |
| 큰 나무     | 380 이상  |
| 행복 열매 생성 | 600 도달   |


행복 열매가 맺히면 나무의 상태는 씨앗 상태로 돌아갑니다

#### ❥ 열매 시스템
- 나무가 완전히 자라면 열매가 열립니다
- 열매가 열리면 "행복 열매" 개수가 증가합니다
- 열매가 열릴 때마다 축하 편지가 전송됩니다
- 열매가 열리면 스트레스 우물의 물이 일정량 줄어듭니다

<br>

## 스트레스 우물

### 컨셉 및 목적
- 부정적인 감정이 쌓일 수록 물이 차오르는 우물
- 부정적 감정을 쉽게 파악하게 하는 경고/관리 장치  

### 작동 메커니즘
#### ❥ 감정 기여도
다음 감정들이 스트레스 우물에 물을 채웁니다:
- **분노**: 화남, 짜증, 불평불만
- **슬픔**: 우울함, 무기력함, 속상함
- **두려움**: 불안함, 걱정, 초조함
- **놀람** (부정적): 충격, 실망, 황당함 등
- **부끄러움** (부정적): 창피함, 수치심, 민망함 등
- 하루에 부정 감정만 있으면 물이 25점 더 차오릅니다.

**주의**: 놀람과 부끄러움은 문맥에 따라 긍정/부정으로 구분됩니다.



#### ❥ 특별 규칙
- **긍정 감정만 있을 경우**: 물이 30점 줄어듭니다
  - 즉, 순수 긍정 일기를 작성하면 스트레스가 감소합니다
- **행복 열매가 맺힌 경우**: 물이 30점 줄어듭니다  
👉🏻 이러한 특별 규칙들은 우물이 너무 자주 차오르지 않도록 하는 완충 역할을 함과 동시에, 긍정적인 감정에 대한 보상을 더욱 강화합니다.

#### ❥ 넘침 상태
- 물이 100%에 도달하면 "넘침" 상태가 됩니다
- 넘치면 주민들이 위로하는 편지를 자동으로 전송합니다
- 물이 넘친 후 "우물 비우기" 버튼을 누르면 우물이 초기화됩니다.  

<br>

## 편지 시스템

### 컨셉 및 목적
- 마을의 무지개 주민들이 사용자에게 보내는 편지
- 사용자에게 위로, 격려, 공감의 메시지를 제공하며 주민과의 소통을 더욱 체감하게 함
- 편지 이벤트를 통해 사용자가 더 일기를 적극적으로 쓰도록 동기를 부여함
- 감정 변화에 대한 즉각적 피드백(보상/위로)

### 작동 메커니즘
#### ❥ 편지 종류

  | 편지 종류 | 조건         | 보낸 주민           |
  | ----- | ---------- | --------------- |
  | 감정 편지 | 감정 ≥ 70    | 해당 감정 주민        |
  | 축하 편지 | 행복 열매 생성   | 기쁨/사랑 계열 주민     |
  | 위로 편지 | 스트레스 우물 넘침 | 슬픔/두려움/분노 계열 주민 |
  
👉🏻 위로 편지의 경우, 단순히 우물 넘침 이벤트만 발생하면 간혹 부정적인 감정에 대한 패널티처럼 보일 수 있으므로 이를 방지하기 위해 사용자에게 위로와 격려의 메시지를 제공합니다.

<br>


## 와글와글 광장

### 컨셉 및 목적
- 무지개 주민들이 대화를 통해 자신의 감정을 드러내는 공간
- 일기에 대한 세부적 감정 분석 제공
- 주민들의 대화 형식을 통한 스토리텔링 감정 분석
- 주민들과의 채팅을 통해 유연한 양방향 감정 관리 서비스 제공 

### 작동 메커니즘
#### ❥ 참여 규칙
- **주요 감정** (score > 0): 자신의 감정을 주로 표현  
- **반응 감정** (score = 0): 다른 감정들에게 반응만 (위로, 동조, 반박 등)  
👉🏻 대화 생성 시 감정 점수 기반 우선순위를 적용해, 실제 감정 분포와 일관된 스토리텔링을 유지합니다

#### ❥ 대화 생성 과정
1. 감정 분석 결과 확인
2. 주요 감정과 반응 감정 결정
3. GPT-4o-mini가 각 주민의 특성을 반영한 대화 생성
4. 대화를 데이터베이스에 저장

#### ❥ 대화 저장
- 하루의 일기에 대한 대화가 한 번 생성되면 저장됩니다.
- 일기가 덮어씌워지거나, 삭제 후 재작성되면 대화가 재생성됩니다.

#### ❥ 채팅 기능
- 사용자가 주민들과 직접 채팅할 수 있습니다.
- 채팅 내용은 GPT-4o-mini가 생성하며, 각 주민의 성격이 반영됩니다.

<br>

## 마을 사무소

### 컨셉 및 목적
- 일기 아카이브 및 통계를 볼 수 있는 공간
- 사용자의 감정 한눈에 파악
- 사용자의 기분 패턴 분석
- 일기 쓰기 현황 제공을 통한 동기 부여

### 작동 메커니즘
사용자는 과거의 날짜를 자유롭게 선택하여 일기를 작성할 수 있고, 이로 인한 통계 표시 혼란을 방지하기 위해 마을 사무소는 무조건 서비스 사용 당시 날짜(오늘)을 기준으로 통계를 제공한다.
#### ❥ 감정 캘린더
- 날짜를 선택하면 해당 날짜의 일기와 감정 분석 결과 확인 가능
- 하루에 가장 비중이 많은 감정 주민의 색을 캘린더에 표시하여 날짜별 주요 감정 시각화 
#### ❥ 비슷한 일기 찾기
- 텍스트 중심에 감정을 함께 고려하여 비슷한 일기를 찾아 줌
- 비슷한 상황일 때 같은 감정을 느꼈는지, 다른 감정을 느꼈는지 파악 가능 
#### ❥ 월간 감정 비율
- 감정별 비중을 한눈에 파악하여 사용자의 한 달간 감정 상태 파악 
#### ❥ 주간 긍정/부정 추이
- 일주일간의 긍정/부정 지수를 그래프로 나타내어 감정 기복 파악 
#### ❥ 일기 작성일
- 한 달동안/일주일동안 일기를 며칠 작성했는지 계산
- 끊기지 않고 연속으로 며칠째 일기를 쓰고 있는지 계산  
👉🏻 동기 부여  
#### ❥ 요일별 일기 작성 횟수
- 일기 작성 패턴 파악 가능  
#### ❥ 감정별 평균 점수
- 비율 뿐만 아니라 각 감정 별로 평균 점수 확인 가능 

ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ  
[← README로 돌아가기](../README.md)
