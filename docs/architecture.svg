<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <!-- 배경 -->
  <rect width="1200" height="800" fill="#f8f9fa"/>
  
  <!-- 제목 -->
  <text x="600" y="35" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle" fill="#333">
    MoodTown 시스템 아키텍처
  </text>
  
  <!-- ========== 레이어 1: 사용자 ========== -->
  <rect x="550" y="60" width="100" height="50" rx="8" fill="#e1f5ff" stroke="#4a90e2" stroke-width="2"/>
  <text x="600" y="85" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">사용자</text>
  
  <!-- 화살표: 사용자 -> 프론트엔드 -->
  <path d="M 600 110 L 600 140" stroke="#4a90e2" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- ========== 레이어 2: 프론트엔드 ========== -->
  <rect x="450" y="140" width="300" height="80" rx="8" fill="#61dafb" stroke="#4a90e2" stroke-width="2"/>
  <text x="600" y="165" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">React + Vite (프론트엔드)</text>
  <text x="600" y="185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">세션 관리 | 캐시 관리 | 컴포넌트 렌더링</text>
  <text x="600" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">일기 작성 | 감정 분석 결과 표시 | 게임 요소 시각화</text>
  
  <!-- 화살표: 프론트엔드 -> 백엔드 -->
  <path d="M 600 220 L 600 250" stroke="#4a90e2" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="620" y="235" font-family="Arial, sans-serif" font-size="10" fill="#666">HTTP/HTTPS REST API</text>
  
  <!-- ========== 레이어 3: 백엔드 ========== -->
  <rect x="200" y="250" width="800" height="150" rx="8" fill="#ffd43b" stroke="#4a90e2" stroke-width="2"/>
  <text x="600" y="275" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">Flask 백엔드 서버</text>
  
  <!-- API 박스들 -->
  <rect x="220" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="265" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">인증</text>
  
  <rect x="330" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="375" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">일기</text>
  
  <rect x="440" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="485" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">감정 분석</text>
  
  <rect x="550" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="595" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">대화 생성</text>
  
  <rect x="660" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="705" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">유사 일기</text>
  
  <rect x="770" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="815" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">나무/우물</text>
  
  <rect x="880" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="925" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">편지</text>
  
  <rect x="990" y="290" width="90" height="35" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="1035" y="312" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">채팅</text>
  
  <!-- 하위 설명 -->
  <text x="600" y="355" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">세션 관리, 데이터 검증, 비즈니스 로직 처리</text>
  <text x="600" y="370" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">외부 API 호출, ML 모델 실행, 데이터베이스 연동</text>
  
  <!-- 화살표: 백엔드 -> 하위 레이어들 -->
  <path d="M 400 400 L 200 450" stroke="#336791" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="280" y="430" font-family="Arial, sans-serif" font-size="10" fill="#666">데이터 저장/조회</text>
  
  <path d="M 600 400 L 600 450" stroke="#10a37f" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="620" y="430" font-family="Arial, sans-serif" font-size="10" fill="#666">감정 분석/대화 생성</text>
  
  <path d="M 705 400 L 900 450" stroke="#28a745" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="800" y="430" font-family="Arial, sans-serif" font-size="10" fill="#666">유사 일기 검색</text>
  
  <path d="M 705 400 L 1000 550" stroke="#f7931e" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="850" y="480" font-family="Arial, sans-serif" font-size="10" fill="#666">참고용 분석</text>
  
  <!-- ========== 레이어 4: 데이터베이스 ========== -->
  <rect x="50" y="450" width="300" height="280" rx="8" fill="#336791" stroke="#4a90e2" stroke-width="2"/>
  <text x="200" y="475" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#fff">PostgreSQL</text>
  <text x="200" y="495" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#fff">데이터베이스</text>
  
  <rect x="70" y="510" width="250" height="25" rx="4" fill="#ffffff" stroke="#336791" stroke-width="1"/>
  <text x="195" y="528" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">diaries - 일기 데이터</text>
  
  <rect x="70" y="545" width="250" height="25" rx="4" fill="#ffffff" stroke="#336791" stroke-width="1"/>
  <text x="195" y="563" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">users - 사용자 정보</text>
  
  <rect x="70" y="580" width="250" height="25" rx="4" fill="#ffffff" stroke="#336791" stroke-width="1"/>
  <text x="195" y="598" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">tree_state - 행복 나무 상태</text>
  
  <rect x="70" y="615" width="250" height="25" rx="4" fill="#ffffff" stroke="#336791" stroke-width="1"/>
  <text x="195" y="633" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">well_state - 스트레스 우물 상태</text>
  
  <rect x="70" y="650" width="250" height="25" rx="4" fill="#ffffff" stroke="#336791" stroke-width="1"/>
  <text x="195" y="668" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">letters - 편지</text>
  
  <rect x="70" y="685" width="250" height="25" rx="4" fill="#ffffff" stroke="#336791" stroke-width="1"/>
  <text x="195" y="703" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">plaza_conversations - 광장 대화</text>
  
  <!-- ========== 레이어 4: OpenAI API ========== -->
  <rect x="450" y="450" width="300" height="120" rx="8" fill="#10a37f" stroke="#4a90e2" stroke-width="2"/>
  <text x="600" y="475" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#fff">OpenAI API</text>
  <text x="600" y="495" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#fff">GPT-4o-mini</text>
  
  <rect x="470" y="510" width="260" height="25" rx="4" fill="#ffffff" stroke="#10a37f" stroke-width="1"/>
  <text x="600" y="528" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">감정 분석 (최종 저장용)</text>
  
  <rect x="470" y="545" width="260" height="25" rx="4" fill="#ffffff" stroke="#10a37f" stroke-width="1"/>
  <text x="600" y="563" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">대화 생성 (와글와글 광장)</text>
  
  <rect x="470" y="580" width="260" height="25" rx="4" fill="#ffffff" stroke="#10a37f" stroke-width="1"/>
  <text x="600" y="598" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">편지 생성 (우체통)</text>
  
  <!-- ========== 레이어 4: ML 모델들 ========== -->
  <rect x="850" y="450" width="300" height="280" rx="8" fill="#f0f0f0" stroke="#4a90e2" stroke-width="2"/>
  <text x="1000" y="475" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">ML 모델</text>
  
  <!-- 유사 일기 검색 (실제 기능) -->
  <rect x="870" y="500" width="260" height="100" rx="6" fill="#28a745" stroke="#4a90e2" stroke-width="2"/>
  <text x="1000" y="525" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#fff">Doc2Vec 모델</text>
  <text x="1000" y="545" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#fff">유사 일기 검색</text>
  <text x="1000" y="560" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#fff">(실제 기능)</text>
  <rect x="890" y="570" width="220" height="20" rx="3" fill="#ffffff" stroke="#28a745" stroke-width="1"/>
  <text x="1000" y="583" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">diary_similarity_doc2vec.model</text>
  
  <!-- 참고용 ML 모델 -->
  <rect x="870" y="620" width="260" height="90" rx="6" fill="#f7931e" stroke="#4a90e2" stroke-width="2"/>
  <text x="1000" y="645" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#fff">ML 감정 분석</text>
  <text x="1000" y="665" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#fff">(참고용)</text>
  <rect x="890" y="680" width="220" height="20" rx="3" fill="#ffffff" stroke="#f7931e" stroke-width="1"/>
  <text x="1000" y="693" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">emotion_ml.joblib</text>
  
  <!-- 화살표 정의 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4a90e2"/>
    </marker>
  </defs>
</svg>
